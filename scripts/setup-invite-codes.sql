-- üîê SETUP ALPHA INVITE CODE SYSTEM
-- Run this script in Supabase SQL Editor

-- Step 1: Add invite_code column to alpha_users table (if not exists)
ALTER TABLE alpha_users
ADD COLUMN IF NOT EXISTS invite_code VARCHAR(20) UNIQUE;

-- Step 2: Add index for performance
CREATE INDEX IF NOT EXISTS idx_alpha_users_invite_code
ON alpha_users(invite_code);

-- Step 3: Set invite codes for all existing test users
-- Using the format MIXMI-XXXXXX
UPDATE alpha_users SET invite_code = 'MIXMI-E7PS84' WHERE wallet_address = 'SP3YXETJCM777DYZMARH1T7P55X0Q58696BBXJ462';
UPDATE alpha_users SET invite_code = 'MIXMI-B2Q8K1' WHERE wallet_address = 'SP20GF14NEB1MJAEPWFCP1G2X02ARP8VH1R2QAJKA';
UPDATE alpha_users SET invite_code = 'MIXMI-P9R4M7' WHERE wallet_address = 'SP3P08QBCVS8K93MDV8YVZ9H3009AC5B8TA67WG0N';
UPDATE alpha_users SET invite_code = 'MIXMI-L3D6N2' WHERE wallet_address = 'SPZ02ESS4SMXVNZ9CXXQWGCTAWJ1APD6MAPWK9EQ';
UPDATE alpha_users SET invite_code = 'MIXMI-S4T8W5' WHERE wallet_address = 'SP19CAXYZ89Q7DZWAGGTVPQZBGNVGGV9K7A9DH2E8';
UPDATE alpha_users SET invite_code = 'MIXMI-H6Y1X3' WHERE wallet_address = 'SP37D6RYVV3KVT2CP41GQC62PBYGN42WHE88FAGYG';

-- Step 4: Verify the invite codes were set
SELECT wallet_address, artist_name, approved, invite_code
FROM alpha_users
WHERE wallet_address IN (
  'SP3YXETJCM777DYZMARH1T7P55X0Q58696BBXJ462',
  'SP20GF14NEB1MJAEPWFCP1G2X02ARP8VH1R2QAJKA',
  'SP3P08QBCVS8K93MDV8YVZ9H3009AC5B8TA67WG0N',
  'SPZ02ESS4SMXVNZ9CXXQWGCTAWJ1APD6MAPWK9EQ',
  'SP19CAXYZ89Q7DZWAGGTVPQZBGNVGGV9K7A9DH2E8',
  'SP37D6RYVV3KVT2CP41GQC62PBYGN42WHE88FAGYG'
)
ORDER BY artist_name;

-- ‚úÖ Invite codes assigned:
-- MIXMI-E7PS84 ‚Üí sandyhoover-account9 (SP3YXETJCM777DYZMARH1T7P55X0Q58696BBXJ462)
-- MIXMI-B2Q8K1 ‚Üí mixmi.btc (SP20GF14NEB1MJAEPWFCP1G2X02ARP8VH1R2QAJKA)
-- MIXMI-P9R4M7 ‚Üí sandyhoover.btc (SP3P08QBCVS8K93MDV8YVZ9H3009AC5B8TA67WG0N)
-- MIXMI-L3D6N2 ‚Üí lunardrive.btc (SPZ02ESS4SMXVNZ9CXXQWGCTAWJ1APD6MAPWK9EQ)
-- MIXMI-S4T8W5 ‚Üí S_account4 (SP19CAXYZ89Q7DZWAGGTVPQZBGNVGGV9K7A9DH2E8)
-- MIXMI-H6Y1X3 ‚Üí s_h_.btc (SP37D6RYVV3KVT2CP41GQC62PBYGN42WHE88FAGYG)
