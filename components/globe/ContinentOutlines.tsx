"use client";

import React, { useMemo } from 'react';
import * as THREE from 'three';

// More detailed continent outlines data
const continentData = {
  africa: [
    [37, -10], [36, -5], [35, 0], [36, 5], [37, 10], [36, 15], [35, 20], 
    [32, 23], [30, 25], [25, 22], [20, 20], [15, 17], [12, 15], 
    [10, 12], [8, 10], [5, 8], [2, 7], [0, 10], [-2, 12], [-5, 15], 
    [-8, 18], [-10, 20], [-12, 22], [-15, 25], [-18, 27], [-20, 30],
    [-23, 29], [-25, 28], [-28, 26], [-30, 25], [-32, 23], [-35, 20], 
    [-34, 18], [-33, 15], [-31, 12], [-28, 10], [-25, 8], [-22, 5],
    [-20, 3], [-17, 0], [-15, -2], [-12, -5], [-10, -7], [-7, -10], 
    [-5, -12], [-2, -10], [0, -8], [3, -5], [5, -2], [8, 0], [10, 3], 
    [13, 5], [15, 7], [18, 8], [20, 10], [23, 9], [25, 8], [28, 6], 
    [30, 5], [32, 2], [35, -3], [37, -10]
  ],
  europe: [
    [71, 25], [70, 40], [65, 45], [60, 50], [55, 45], [50, 40], [45, 35],
    [40, 30], [37, 20], [36, 10], [37, 0], [40, -5], [45, -8], [50, -5],
    [55, 0], [60, 10], [65, 20], [71, 25]
  ],
  asia: [
    [71, 25], [70, 60], [65, 80], [60, 100], [55, 120], [50, 135], [45, 140],
    [40, 135], [35, 130], [30, 125], [25, 120], [20, 115], [15, 110], [10, 105],
    [5, 100], [0, 95], [-5, 100], [-10, 115], [-8, 130], [0, 140], [10, 145],
    [20, 140], [30, 135], [40, 140], [50, 145], [60, 140], [65, 120], [70, 80],
    [71, 25]
  ],
  northAmerica: [
    [71, -170], [70, -160], [65, -150], [60, -140], [55, -130], [50, -120],
    [45, -115], [40, -110], [35, -105], [30, -100], [25, -95], [20, -90],
    [15, -85], [10, -80], [15, -75], [20, -70], [25, -65], [30, -60],
    [35, -65], [40, -70], [45, -75], [50, -80], [55, -85], [60, -90],
    [65, -100], [70, -120], [71, -140], [71, -170]
  ],
  southAmerica: [
    [10, -80], [5, -78], [0, -75], [-5, -70], [-10, -65], [-15, -60],
    [-20, -55], [-25, -52], [-30, -50], [-35, -52], [-40, -55], [-45, -60],
    [-50, -65], [-55, -70], [-53, -75], [-50, -73], [-45, -70], [-40, -65],
    [-35, -60], [-30, -55], [-25, -50], [-20, -45], [-15, -40], [-10, -35],
    [-5, -40], [0, -45], [5, -50], [10, -55], [12, -60], [10, -70], [8, -75],
    [10, -80]
  ],
  australia: [
    [-10, 140], [-12, 145], [-15, 150], [-20, 152], [-25, 153], [-30, 152],
    [-35, 150], [-38, 145], [-40, 140], [-38, 135], [-35, 130], [-30, 125],
    [-25, 123], [-20, 120], [-15, 122], [-12, 125], [-10, 130], [-10, 140]
  ]
};

export function ContinentOutlines() {
  const continentMeshes = useMemo(() => {
    return Object.entries(continentData).map(([name, continent]) => {
      const points: THREE.Vector3[] = [];
      
      // Convert lat/lng to 3D positions for each continent
      continent.forEach((coord) => {
        const [lat, lng] = coord;
        const phi = (90 - lat) * (Math.PI / 180);
        const theta = (lng + 180) * (Math.PI / 180);
        const radius = 1.008; // Slightly above the globe surface
        
        const x = -(radius * Math.sin(phi) * Math.cos(theta));
        const y = radius * Math.cos(phi);
        const z = radius * Math.sin(phi) * Math.sin(theta);
        
        points.push(new THREE.Vector3(x, y, z));
      });
      
      // Create a line loop for each continent
      const geometry = new THREE.BufferGeometry().setFromPoints(points);
      
      return { name, geometry };
    });
  }, []);

  return (
    <>
      {continentMeshes.map(({ name, geometry }) => (
        <lineLoop key={name} geometry={geometry}>
          <lineBasicMaterial 
            color="#9CA3AF" 
            linewidth={3}
            opacity={0.9}
            transparent
          />
        </lineLoop>
      ))}
    </>
  );
}